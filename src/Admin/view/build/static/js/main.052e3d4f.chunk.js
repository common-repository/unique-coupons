(this["webpackJsonpunique-coupons-admin"]=this["webpackJsonpunique-coupons-admin"]||[]).push([[0],{214:function(e,t,n){"use strict";n.r(t);var a,r=n(2),c=n(0),o=n.n(c),i=n(14),u=n.n(i),s=n(29),p=n(22),l=n(288),d=n(282),j=n(13),b=n(20),h=n(218),f=n(274),O=n(126),g=n(257),x=n(157),m=n(8),v=n(268),y=n(258),w=n(85),_=n.n(w),C=n(153),I=n.n(C),k=n(17),A=n(53),S=n(254),G=Object(y.a)((function(e){return{extendedIcon:{marginRight:e.spacing(1)},progress:{position:"absolute",top:"50%",left:14,marginTop:-14}}})),B=function(e){var t=e.children,n=e.Icon,a=e.isLoading,c=Object(A.a)(e,["children","Icon","isLoading"]),o=G();return Object(r.jsxs)(S.a,Object(m.a)(Object(m.a)({color:"primary",variant:"extended",disabled:a},c),{},{children:[Object(r.jsx)(n,{className:o.extendedIcon}),t,a&&Object(r.jsx)(g.a,{size:28,className:o.progress})]}))},q=n(263),R=n(264),M=n(283),T=n(106),E=n.n(T),N=n(156),D=(n(184),n(188),n(190),n(192),n(194),n(196),n(198),n(200),n(202),n(204),n(206),n(208),"#666"),F='\n\t[class^="unique-coupons-popup__"] {\n\t\tposition: relative;\n\t\tborder: 1px dashed '.concat(D,';\n\t}\n\t.unique-coupons-popup__coupon {\n\t\tpadding-top: 0.5em;\n\t}\n\t[class^="unique-coupons-popup__"]::after {\n\t\tposition: absolute;\n\t\twidth: max-content;\n\t\ttop: 0;\n\t\tleft: 50%;\n\t\ttransform: translate(-50%, -75%);\n\t\tfont-size: 90%;\n\t\tcolor: ').concat(D,';\n\t\tbackground-color: white;\n\t\topacity: 0;\n\t\ttransition: opacity 0.2s;\n\t\tpadding: 2px 4px;\n\t\tborder-radius: 4px;\n\t\tbox-shadow: 2px 2px 4px;\n\t}\n\t[class^="unique-coupons-popup__"]:hover::after {\n\t\topacity: 1;\n\t}\n\t.unique-coupons-popup__button::after {\n\t\tcontent: "Action area";\n\t}\n\t.unique-coupons-popup__coupon::after {\n\t\tcontent: "Success area";\n\t}\n\t.unique-coupons-popup__value::after {\n\t\tcontent: "Coupon value";\n\t}\n\t.unique-coupons-popup__expires-at::after {\n\t\tcontent: "Expiry date";\n\t}\n'),L=function(e){var t=e.template,n=e.handleChange,a=Object(A.a)(e,["template","handleChange"]);return Object(r.jsx)(f.a,{marginY:2,children:Object(r.jsx)(N.a,Object(m.a)({init:{height:300,plugins:"paste link image template code autoresize help lists",toolbar:["undo redo | styleselect | bold italic | link image | alignleft aligncenter alignright alignjustify | outdent indent | code | help","actionButton successArea couponValue expiresAt"],content_style:F,branding:!1,formats:{successArea:{block:"div",classes:"unique-coupons-popup__coupon"},couponValue:{inline:"span",classes:"unique-coupons-popup__value"},expiresAt:{inline:"span",classes:"unique-coupons-popup__expires-at"},actionButton:{inline:"button",classes:"unique-coupons-popup__button"}},setup:function(e){e.ui.registry.addButton("couponValue",{text:"Coupon value",onAction:function(){return e.formatter.toggle("couponValue")}}),e.ui.registry.addButton("expiresAt",{text:"Expiry date",onAction:function(){return e.formatter.toggle("expiresAt")}}),e.ui.registry.addButton("successArea",{text:"Success area",onAction:function(){return e.formatter.toggle("successArea")}}),e.ui.registry.addButton("actionButton",{text:"Action button",onAction:function(){return e.formatter.toggle("actionButton")}})}},value:t,onEditorChange:function(e,t){return n(e)}},a))})},P=Object(y.a)((function(e){return{root:function(t){return{"& .MuiInput-input":Object(m.a)(Object(m.a)({},e.typography[t.variant]),{},{height:"unset","&::placeholder":{fontStyle:"italic"}}),marginRight:e.spacing(1),width:"100%"}}}})),V=function(e){var t=e.initialValues,n=e.handleSubmit,a=e.submitButtonText,o=e.isLoading,i=Object(c.useState)(t),u=Object(j.a)(i,2),s=u[0],p=u[1],l=s.name,d=s.description,b=s.template,h=s.isActive;return Object(r.jsxs)("div",{children:[Object(r.jsx)(f.a,{marginBottom:1.5,children:Object(r.jsx)(M.a,{value:l,onChange:function(e){return p(Object(m.a)(Object(m.a)({},s),{},{name:e.target.value}))},disabled:o,autoFocus:!0,placeholder:"Group Title",className:P({variant:"h3"}).root})}),Object(r.jsx)(f.a,{marginBottom:1.5,children:Object(r.jsx)(M.a,{value:d,onChange:function(e){return p(Object(m.a)(Object(m.a)({},s),{},{description:e.target.value}))},disabled:o,placeholder:"Group Description (optional)",className:P({variant:"subtitle1"}).root})}),Object(r.jsx)(q.a,{control:Object(r.jsx)(R.a,{checked:h,onChange:function(e){return p(Object(m.a)(Object(m.a)({},s),{},{isActive:e.target.checked}))}}),disabled:o,label:"Is active?"}),Object(r.jsx)(L,{template:b,handleChange:function(e){return p(Object(m.a)(Object(m.a)({},s),{},{template:e}))},disabled:o}),Object(r.jsx)(B,{Icon:E.a,isLoading:o,onClick:function(){return n(s)},children:a})]})},z=function(e){var t=e.isActive,n=e.handleChange;return Object(r.jsx)(q.a,{label:"Is active?",control:Object(r.jsx)(R.a,{checked:t,onChange:function(e){return n(e.target.checked)}})})},U=n(289),H=n(23),J=n(12),W=n.n(J),Y=n(27),Q=n(100),X=n(285),K=n(265),Z=n(280),$=n(275),ee=n(149),te=n(284),ne=window.UNIQUE_COUPONS.api,ae=new function e(){var t=this;Object(ee.a)(this,e),this.addGroup=function(){var e=Object(Y.a)(W.a.mark((function e(n){var a;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.post(ne.group,t.transformGroupRequestBody(n));case 2:return a=e.sent,e.abrupt("return",t.transformGroupResponse(a));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.addCoupons=function(){var e=Object(Y.a)(W.a.mark((function e(n){var a,r,c,o;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.couponValues,r=n.groupId,c=n.expiresAt,e.next=3,t.post(ne.coupons+"/create",t.transformAddCouponsRequestBody(r,a,c));case 3:return o=e.sent,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getGroups=Object(Y.a)(W.a.mark((function e(){var n;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get(ne.group,{orderby:"id",order:"desc",per_page:100});case 2:return n=e.sent,e.abrupt("return",t.transformGroupsResponse(n));case 4:case"end":return e.stop()}}),e)}))),this.getCoupons=function(){var e=Object(Y.a)(W.a.mark((function e(n){var a;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get(ne.coupons,{group_id:n});case 2:return a=e.sent,e.abrupt("return",t.transformGetCouponsResponse(a));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.editGroup=function(){var e=Object(Y.a)(W.a.mark((function e(n,a){var r;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.post("".concat(ne.group,"/").concat(n),t.transformGroupRequestBody(a));case 2:return r=e.sent,e.abrupt("return",t.transformGroupResponse(r));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.deleteGroup=function(){var e=Object(Y.a)(W.a.mark((function e(n){var a,r;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.delete("".concat(ne.group,"/").concat(n),{force:!0});case 2:return r=e.sent,e.abrupt("return",null===r||void 0===r||null===(a=r.previous)||void 0===a?void 0:a.id);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.activateCoupons=function(){var e=Object(Y.a)(W.a.mark((function e(n){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.post(ne.coupons+"/activate",{coupon_ids:n}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.deactivateCoupons=function(){var e=Object(Y.a)(W.a.mark((function e(n){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.post(ne.coupons+"/deactivate",{coupon_ids:n}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.deleteCoupons=function(){var e=Object(Y.a)(W.a.mark((function e(n){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.post(ne.coupons+"/delete",{coupon_ids:n}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getOptions=function(){return t.get(ne.options)},this.setOptions=function(e){return t.post(ne.options,e)},this.fetch=function(){var e=Object(Y.a)(W.a.mark((function e(t,n){var a,r;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,Object(m.a)(Object(m.a)({},n),{},{credentials:"same-origin",headers:Object(m.a)(Object(m.a)({},n.headers),{},{"Content-Type":"application/json","X-WP-Nonce":ne.nonce})}));case 2:return a=e.sent,e.next=5,a.json();case 5:if(r=e.sent,a.ok){e.next=8;break}throw new Error(r.message);case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.get=function(){var e=Object(Y.a)(W.a.mark((function e(n){var a,r,c=arguments;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>1&&void 0!==c[1]?c[1]:{},r=function(e,t){var n=new URLSearchParams(t).toString(),a=e.includes("?")?"&":"?";return n?"".concat(e).concat(a).concat(n):e},e.abrupt("return",t.fetch(r(n,a),{method:"GET"}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.post=function(){var e=Object(Y.a)(W.a.mark((function e(n){var a,r=arguments;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",t.fetch(n,{method:"POST",body:JSON.stringify(a)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.delete=function(){var e=Object(Y.a)(W.a.mark((function e(n){var a,r=arguments;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",t.fetch(n,{method:"DELETE",body:JSON.stringify(a)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.transformGroupRequestBody=function(e){var t={};return"name"in e&&Object(te.a)(t,"name",e.name),"description"in e&&Object(te.a)(t,"description",e.description),"template"in e&&Object(te.a)(t,"meta.template",e.template),"isActive"in e&&Object(te.a)(t,"meta.is_active",e.isActive),t},this.transformGroupResponse=function(e){return{id:e.id,name:e.name,description:e.description,template:e.meta.template,isActive:e.meta.is_active,couponIds:[]}},this.transformGroupsResponse=function(e){return e.map(t.transformGroupResponse)},this.transformAddCouponsRequestBody=function(e,t,n){return{group_id:e,coupon_values:t,expires_at:n}},this.transformGetCouponsResponse=function(e){return e.map((function(e){return{id:e.id,value:e.value,expiresAt:e.expires_at,status:e.status,userId:e.user_id}}))}},re=Object(k.b)("coupons/addGroup",ae.addGroup),ce=Object(k.b)("coupons/addCoupons",function(){var e=Object(Y.a)(W.a.mark((function e(t){var n,a,r,c;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.couponValues,a=t.expiresAt,r=t.groupId,e.next=3,ae.addCoupons({couponValues:n,expiresAt:a,groupId:r});case 3:return c=e.sent,e.abrupt("return",{groupId:r,coupons:Object(X.a)(c,n,(function(e,t){return{id:e,value:t,expiresAt:a}}))});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),oe=Object(k.b)("coupons/getGroups",ae.getGroups),ie=Object(k.b)("coupons/getCoupons",function(){var e=Object(Y.a)(W.a.mark((function e(t){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,ae.getCoupons(t);case 3:return e.t1=e.sent,e.abrupt("return",{groupId:e.t0,coupons:e.t1});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ue=Object(k.b)("coupons/editGroup",function(){var e=Object(Y.a)(W.a.mark((function e(t,n){var a,r,c,o;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.groupId,r=Object(A.a)(t,["groupId"]),c=n.rejectWithValue,e.next=4,ae.editGroup(a,r);case 4:if(o=e.sent,Object(K.a)(o,Object(m.a)({id:a},r))){e.next=7;break}return e.abrupt("return",c(o));case 7:return e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),se=Object(k.b)("coupons/deleteGroup",ae.deleteGroup),pe={activate:Object(k.b)("coupons/activate",ae.activateCoupons),deactivate:Object(k.b)("coupons/deactivate",ae.deactivateCoupons),delete:Object(k.b)("coupons/delete",ae.deleteCoupons)},le=Object(k.c)(),de=Object(k.c)(),je={couponGroups:le.getInitialState(),coupons:de.getInitialState()},be=Object(k.d)({name:"coupons",initialState:je,reducers:{},extraReducers:(a={},Object(H.a)(a,re.fulfilled,(function(e,t){var n=t.payload;le.addOne(e.couponGroups,n)})),Object(H.a)(a,ce.fulfilled,(function(e,t){var n=t.payload;ve(e,n.groupId,n.coupons)})),Object(H.a)(a,oe.fulfilled,(function(e,t){var n=t.payload;le.setAll(e.couponGroups,n)})),Object(H.a)(a,ie.fulfilled,(function(e,t){var n=t.payload,a=n.groupId,r=n.coupons;!function(e,t){var n=e.couponGroups.entities[t].couponIds;le.updateOne(e.couponGroups,{id:t,changes:{couponIds:[]}}),de.removeMany(e.coupons,n)}(e,a),ve(e,a,r)})),Object(H.a)(a,ue.pending,(function(e,t){var n=t.meta.arg,a=n.groupId,r=Object(A.a)(n,["groupId"]);le.updateOne(e.couponGroups,{id:a,changes:r})})),Object(H.a)(a,ue.fulfilled,(function(e,t){var n=t.payload,a=n.id,r=Object(A.a)(n,["id"]);le.updateOne(e.couponGroups,{id:a,changes:r})})),Object(H.a)(a,ue.rejected,(function(e,t){var n=t.payload;if(null===n||void 0===n?void 0:n.id){var a=n.id,r=Object(A.a)(n,["id"]);le.updateOne(e.couponGroups,{id:a,changes:r})}})),Object(H.a)(a,se.fulfilled,(function(e,t){var n=t.payload;le.removeOne(e.couponGroups,n)})),Object(H.a)(a,pe.activate.fulfilled,(function(e,t){var n=t.meta.arg;de.updateMany(e.coupons,n.map((function(e){return{id:e,changes:{status:"active"}}})))})),Object(H.a)(a,pe.deactivate.fulfilled,(function(e,t){var n=t.meta.arg;de.updateMany(e.coupons,n.map((function(e){return{id:e,changes:{status:"inactive"}}})))})),Object(H.a)(a,pe.delete.fulfilled,(function(e,t){var n=t.meta.arg;de.removeMany(e.coupons,n)})),a)}),he=le.getSelectors((function(e){return e.coupons.couponGroups})),fe=he.selectById,Oe=he.selectIds,ge=de.getSelectors((function(e){return e.coupons.coupons})).selectById,xe=Object(Q.a)((function(e){return e.coupons.coupons}),(function(e,t){return fe(e,t)}),(function(e,t){return Object(Z.a)(t.couponIds.map((function(t){return e.entities[t]})),"status")})),me=be.reducer;function ve(e,t,n){!function(e,t,n){var a=Object(U.a)(n,"id"),r=e.couponGroups.entities[t].couponIds,c=Object($.a)(r,a);le.updateOne(e.couponGroups,{id:t,changes:{couponIds:c}})}(e,t,n),de.addMany(e.coupons,n)}var ye=n(266),we=n(278),_e=n(267),Ce=n(281),Ie=Object(x.a)("div")({padding:"1em","&:not(:last-of-type)":{borderBottom:"1px solid #ccc"},"&:hover":{background:"#eee"}}),ke=function(){return Object(r.jsxs)(Ge,{children:[Object(r.jsx)(g.a,{size:30,style:{marginRight:5}}),Object(r.jsx)(O.a,{children:"Updating entries"})]})},Ae=function(){return Object(r.jsx)(Ge,{children:Object(r.jsx)(O.a,{children:"No entries"})})},Se={display:"flex",alignItems:"center",gap:"1em"},Ge=Object(x.a)(Ie)(Se),Be=Object(x.a)("div")(Object(m.a)(Object(m.a)({},Se),{},{padding:"0.6em 1em",borderBottom:"1px solid #888"})),qe=Object(x.a)(Ce.a)({margin:-10}),Re=function(e){var t=e.ids,n=e.Row,a=e.BulkActions,o=void 0===a?function(e){return null}:a,i=e.isFetching,u=void 0!==i&&i,s=Object(c.useState)([]),p=Object(j.a)(s,2),l=p[0],d=p[1],b=function(e){return l.includes(e)},f=function(){return t.length===l.length},O=function(){return 0===l.length},g=Object(r.jsxs)(Be,{children:[Object(r.jsx)(qe,{checked:f()&&!O(),indeterminate:!f()&&!O(),onChange:function(){return f()?d([]):d(t)}}),Object(r.jsx)(o,{ids:l})]}),x=0===t.length?Object(r.jsx)(Ae,{}):t.map((function(e){return Object(r.jsxs)(Ge,{children:[Object(r.jsx)(qe,{checked:b(e),onChange:function(){return function(e){return d((function(t){return b(e)?t.filter((function(t){return t!==e})):t.concat(e)}))}(e)}}),Object(r.jsx)(n,{id:e})]},e)}));return Object(r.jsxs)(h.a,{square:!0,children:[u?Object(r.jsx)(ke,{}):null,g,x]})},Me=n(219),Te=n(277),Ee=n(292),Ne=n(261),De=n(152),Fe=n.n(De),Le=n(151),Pe=n.n(Le),Ve=n(136),ze=n(26),Ue=n(276),He=document.createElement("div"),Je=document.createElement("div");Je.setAttribute("id","app-root");var We=document.createComment("jss-insertion-point"),Ye=Object(ze.b)(Object(m.a)(Object(m.a)({},Object(Ue.a)()),{},{insertionPoint:We})),Qe=document.createElement("link");Qe.setAttribute("rel","stylesheet"),Qe.setAttribute("href","https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"),document.getElementById("unique-coupons-root").shadowRoot.appendChild(He),He.appendChild(Qe),He.appendChild(We),He.appendChild(Je);var Xe=Object(x.a)("div")((function(e){return{display:"flex",justifyContent:"flex-end",alignItems:"center",padding:e.theme.spacing(1)}})),Ke=function(e){return Object(r.jsx)(Me.a,Object(m.a)(Object(m.a)({size:"small"},e),{},{children:Object(r.jsx)(Pe.a,{})}))},Ze=function(e){return Object(r.jsx)(Me.a,Object(m.a)(Object(m.a)({size:"small"},e),{},{children:Object(r.jsx)(Fe.a,{})}))},$e=Object(x.a)(Ne.a)((function(e){var t=e.theme;return{display:"flex",alignItems:"center",marginLeft:t.spacing(2),gap:t.spacing(1)}})),et=function(e){var t=e.items,n=e.initialPage,a=void 0===n?1:n,o=e.perPage,i=void 0===o?10:o,u=e.getComponent,s=Math.ceil(t.length/i)||1,p=function(e){return Object(Ve.clamp)(e,1,s)},l=Object(c.useState)(a),d=Object(j.a)(l,2),b=d[0],h=d[1],f=function(e){return h(p(e))};p(b)!==b&&f(b);var O=Object(Ve.range)(1,s+1),g=t.slice((b-1)*i,b*i),x=Object(r.jsx)(Te.a,{value:b,onChange:function(e){return f(e.target.value)},label:"Page",MenuProps:{container:Je},children:O.map((function(e){return Object(r.jsx)(Ee.a,{value:e,children:e},e)}))}),m=Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ke,{onClick:function(){return f(b-1)},disabled:p(b-1)===b}),Object(r.jsx)(Ze,{onClick:function(){return f(b+1)},disabled:p(b+1)===b})]}),v=Object(r.jsxs)(Xe,{children:[m,Object(r.jsxs)($e,{children:["Page ",x," of ",s]})]});return Object(r.jsxs)(r.Fragment,{children:[u(g),v]})};function tt(e){var t=new Date;return t.setTime(1e3*e),t.toLocaleDateString(void 0,{day:"numeric",month:"long",year:"numeric"})}var nt=function(e){var t=e.couponId,n=Object(p.c)((function(e){return ge(e,t)})),a=n.value,c=n.expiresAt,o=n.userId;return Object(r.jsxs)(at,{children:[Object(r.jsx)(O.a,{component:"b",children:a}),Object(r.jsx)(O.a,{children:tt(c)}),o?Object(r.jsxs)(O.a,{children:["User ID: ",o]}):null]})},at=Object(x.a)("div")((function(e){return{display:"flex",width:"100%",textAlign:"center",gap:e.theme.spacing(2),"& > *":{minWidth:150}}})),rt={active:["deactivate","delete"],inactive:["activate","delete"],used:["delete"],expired:["delete"]},ct=function(e){return function(t){var n=t.ids,a=0===n.length,c=Object(p.b)(),o=rt[e].map((function(e){var t=pe[e];return Object(r.jsx)(v.a,{onClick:function(){return c(t(n))},disabled:a,size:"small",children:e})}));return Object(r.jsx)(r.Fragment,{children:o})}},ot=function(e){var t=e.groupId,n=e.isFetching,a=Object(c.useState)("active"),o=Object(j.a)(a,2),i=o[0],u=o[1],s=Object(p.c)((function(e){return xe(e,t)})),l=Object(U.a)(s[i],"id");return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(ye.a,{position:"static",color:"default",children:Object(r.jsxs)(we.a,{value:i,onChange:function(e,t){return u(t)},children:[Object(r.jsx)(_e.a,{value:"active",label:"Active"}),Object(r.jsx)(_e.a,{value:"inactive",label:"Inactive"}),Object(r.jsx)(_e.a,{value:"used",label:"Used"}),Object(r.jsx)(_e.a,{value:"expired",label:"Expired"})]})}),Object(r.jsx)(et,{items:l,perPage:12,getComponent:function(e){return Object(r.jsx)(Re,{ids:e,Row:function(e){var t=e.id;return Object(r.jsx)(nt,{couponId:t})},BulkActions:ct(i),isFetching:n},e)}},i)]})},it=Object(y.a)((function(e){return{text:{padding:"7px 0 8px"},header:{display:"flex",alignItems:"center","& > *:first-child":{flexGrow:1}}}})),ut=function(e){var t=e.groupId,n=Object(p.c)((function(e){return fe(e,t)})),a=void 0!==n,i=Object(c.useState)(!0),u=Object(j.a)(i,2),l=u[0],d=u[1],b=Object(c.useState)(!1),h=Object(j.a)(b,2),f=h[0],g=h[1],x=Object(c.useState)(!1),y=Object(j.a)(x,2),w=y[0],C=y[1],A=Object(c.useState)(""),S=Object(j.a)(A,2),G=(S[0],S[1]),q=it(),R=Object(p.b)();if(o.a.useEffect((function(){a&&R(ie(t)).then(k.e).then((function(){return d(!1)})).catch((function(e){var t=e.message;return G(t)}))}),[R,a,t]),!a)return Object(r.jsxs)(O.a,{variant:"body1",children:["There is no group with ID ",t]});var M=n.name,T=n.description,E=n.template,N=n.isActive;return f?Object(r.jsx)(V,{initialValues:n,handleSubmit:function(e){C(!0),R(ue(Object(m.a)({groupId:t},e))).then((function(){g(!1),C(!1)}))},submitButtonText:"Save changes",isLoading:w}):Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{className:q.header,children:[Object(r.jsx)(O.a,{variant:"h3",className:q.text,children:M}),Object(r.jsx)(v.a,{onClick:function(){return g(!0)},variant:"contained",startIcon:Object(r.jsx)(I.a,{}),className:q.button,children:"Edit"})]}),T&&Object(r.jsx)(O.a,{variant:"subtitle1",className:q.text,children:T}),Object(r.jsx)(z,{isActive:N,handleChange:function(e){return R(ue({groupId:t,isActive:e}))}}),Object(r.jsx)(L,{template:E,disabled:!0}),Object(r.jsx)(O.a,{variant:"h4",gutterBottom:!0,children:"Coupons"}),Object(r.jsx)(ot,{groupId:t,isFetching:l}),Object(r.jsx)(B,{component:s.b,to:"/add-coupons/".concat(t),Icon:_.a,children:"Add coupons to this group"})]})},st=n(286),pt=n(269),lt=n(154),dt=n.n(lt),jt=Object(x.a)(pt.a)((function(e){return{display:"flex",alignItems:"center",marginBottom:e.theme.spacing(1)}})),bt=Object(x.a)(dt.a)((function(e){return{marginRight:e.theme.spacing(.5),marginTop:-2}})),ht=function(e){var t=e.to,n=e.children;return Object(r.jsxs)(jt,{component:s.b,to:t,variant:"body1",children:[Object(r.jsx)(bt,{}),n]})},ft=Object(x.a)("label")((function(e){return{display:"flex",marginBottom:e.theme.spacing(3),"& > *:first-child":{flexBasis:120,marginTop:15}}})),Ot=function(e){var t=e.groupId,n=Object(p.c)((function(e){return fe(e,t)})),a=void 0!==n,o=Object(c.useState)(Date.now()),i=Object(j.a)(o,2),u=i[0],s=i[1],l=Object(c.useState)(""),d=Object(j.a)(l,2),h=d[0],f=d[1],g=Object(c.useState)(""),x=Object(j.a)(g,2),m=x[0],v=x[1],y=Object(c.useState)(!1),w=Object(j.a)(y,2),C=w[0],I=w[1],A=Object(p.b)(),S=Object(b.f)();if(!a)return Object(r.jsxs)(O.a,{variant:"body1",children:["There is no group with ID ",t]});var G=n.name;return Object(r.jsxs)("div",{children:[Object(r.jsxs)(ht,{to:"/group/".concat(t),children:['Back to Group "',G,'"']}),Object(r.jsxs)(O.a,{variant:"h3",gutterBottom:!0,children:['Add Coupons to Group "',G,'"']}),Object(r.jsxs)(ft,{children:[Object(r.jsx)(O.a,{children:"Expires at"}),Object(r.jsx)(M.a,{type:"date",valueAsNumber:u,autoFocus:!0,required:!0,variant:"outlined",onChange:function(e){return s(e.target.valueAsNumber)}})]}),Object(r.jsxs)(ft,{children:[Object(r.jsx)(O.a,{children:"Coupons"}),Object(r.jsx)(M.a,{value:h,multiline:!0,required:!0,variant:"outlined",rows:"4",rowsMax:"16",helperText:"One coupon per line",onChange:function(e){return f(e.target.value)}})]}),Object(r.jsx)(B,{Icon:_.a,isLoading:C,onClick:function(){if(h&&u){var e=h.split(/\r?\n/).map((function(e){return e.trim()})).filter((function(e){return""!==e})),n=new Date(u);n.setHours(23),n.setMinutes(59),n.setSeconds(59);var a=Math.floor(n.getTime()/1e3);I(!0),A(ce({couponValues:e,expiresAt:a,groupId:t})).then(k.e).then((function(){return S.push("/group/".concat(t))})).catch((function(e){var t=e.message;return v(t)})).finally((function(){return I(!1)}))}else v("Fill all inputs first.")},children:"Add coupons"}),Object(r.jsx)(st.a,{open:!!m,autoHideDuration:6e3,message:m,onClose:function(e,t){return"clickaway"===t||v("")}})]})},gt=n(155),xt=n.n(gt),mt=n(287),vt=n(270),yt=n(271),wt=n(273),_t=n(272),Ct=Object(x.a)("div")({display:"flex",alignItems:"center",gap:"1em"}),It=Object(x.a)("h3")({margin:0}),kt=Object(x.a)("span")({fontStyle:"italic"}),At=Object(x.a)((function(e){return Object(r.jsx)(Me.a,Object(m.a)(Object(m.a)({"aria-label":"delete group"},e),{},{children:Object(r.jsx)(xt.a,{})}))}))({marginLeft:"auto"}),St=Object(x.a)(mt.a)((function(e){return{"& .MuiDialog-paper":{padding:e.theme.spacing(.5,1)}}})),Gt=function(e){var t=e.groupId,n=Object(p.c)((function(e){return fe(e,t)})),a=n.id,o=n.name,i=n.description,u=n.isActive,l=Object(c.useState)(!1),d=Object(j.a)(l,2),b=d[0],h=d[1],O=function(){return h(!1)},g=Object(p.b)();return Object(r.jsxs)(Ct,{children:[Object(r.jsx)(R.a,{checked:u,onChange:function(e){return function(e){return g(ue({groupId:t,isActive:e}))}(e.target.checked)},inputProps:{"aria-label":"toggle group activation"}}),Object(r.jsxs)(f.a,{children:[Object(r.jsx)(s.b,{to:"/group/".concat(a),children:Object(r.jsx)(It,{children:o})}),Object(r.jsx)(kt,{children:i})]}),Object(r.jsx)(At,{onClick:function(){return h(!0)}}),Object(r.jsxs)(St,{open:b,onClose:O,container:Je,children:[Object(r.jsx)(vt.a,{children:"Delete this coupon group?"}),Object(r.jsx)(yt.a,{children:Object(r.jsx)(_t.a,{children:"This action can't be undone."})}),Object(r.jsxs)(wt.a,{children:[Object(r.jsx)(v.a,{onClick:O,children:"Cancel"}),Object(r.jsx)(v.a,{color:"primary",onClick:function(){return g(se(t)).then(O)},children:"Delete"})]})]})]})},Bt=function(){var e=Object(p.c)(Oe);return Object(r.jsx)(h.a,{children:e.map((function(e){return Object(r.jsx)(Ie,{children:Object(r.jsx)(Gt,{groupId:e})},e)}))})},qt=Object(x.a)((function(e){return Object(r.jsx)(B,Object(m.a)(Object(m.a)({component:s.b,to:"/add-coupon-group",Icon:_.a},e),{},{children:"Add a new coupon group"}))}))((function(e){return{marginTop:e.theme.spacing(3)}})),Rt=function(){return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Bt,{}),Object(r.jsx)(qt,{})]})},Mt=n(217),Tt=n(291),Et=Object(x.a)("div")((function(e){var t=e.theme;return Object(H.a)({display:"flex",gap:t.spacing(.5,2)},t.breakpoints.down("xs"),{flexDirection:"column"})})),Nt=Object(x.a)(Tt.a)((function(e){var t=e.theme;return{width:"4rem",marginRight:t.spacing(1),"& .MuiOutlinedInput-input":{padding:t.spacing(1)}}})),Dt=function(e){var t=e%60,n=(e=Math.floor(e/60))%60,a=(e=Math.floor(e/60))%24;return{days:e=Math.floor(e/24),hours:a,minutes:n,seconds:t}},Ft=function(e){return 60*(60*(24*e.days+e.hours)+e.minutes)+e.seconds},Lt=function(e){var t=e.value,n=e.onChange,a=Dt(t),c=a.days,o=a.hours,i=a.minutes,u=a.seconds,s=function(e){return function(t){n(Ft(Object(H.a)({days:c,hours:o,minutes:i,seconds:u},e,Number(t.target.value))))}},p=function(e){return Object(r.jsxs)(Mt.a,{children:[Object(r.jsx)(Nt,{type:"number",value:a[e],onChange:s(e),inputProps:{min:0}}),e]})};return Object(r.jsxs)(Et,{children:[p("days"),p("hours"),p("minutes"),p("seconds")]})},Pt=Object(x.a)("div")((function(e){return{display:"flex",alignItems:"center",gap:e.theme.spacing(2)}})),Vt=function(e){var t=e.label,n=e.value,a=e.handleChange;return Object(r.jsxs)(zt,{children:[Object(r.jsx)(Ut,{children:t}),Object(r.jsx)(Lt,{value:n,onChange:a})]})},zt=Object(x.a)(Mt.a)((function(e){var t=e.theme;return Object(H.a)({display:"flex",flexDirection:"column",gap:t.spacing(1,3),marginBottom:t.spacing(4)},t.breakpoints.up("md"),{flexDirection:"row",alignItems:"center"})})),Ut=Object(x.a)("span")((function(e){var t=e.theme;return Object(H.a)({display:"inline-block",lineHeight:1.5},t.breakpoints.up("md"),{width:300,textAlign:"right"})})),Ht=function(){var e=Object(c.useState)(!0),t=Object(j.a)(e,2),n=t[0],a=t[1],o=Object(c.useState)(!1),i=Object(j.a)(o,2),u=i[0],s=i[1],p=Object(c.useState)({}),l=Object(j.a)(p,2),d=l[0],b=l[1],h=function(e){return function(t){return b((function(n){return Object(m.a)(Object(m.a)({},n),{},Object(H.a)({},e,t))}))}};return Object(c.useEffect)((function(){ae.getOptions().then(b).finally((function(){return a(!1)}))}),[]),n?Object(r.jsxs)(Pt,{children:[Object(r.jsx)(g.a,{}),Object(r.jsx)(O.a,{children:"Loading settings"})]}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(O.a,{variant:"h3",gutterBottom:!0,children:"Settings"}),Object(r.jsx)(Vt,{value:d.seconds_between_any_popup,handleChange:h("seconds_between_any_popup"),label:"Minimum time between any popups"}),Object(r.jsx)(Vt,{value:d.seconds_between_same_popup,handleChange:h("seconds_between_same_popup"),label:"Minimum time between popups of the same group"}),Object(r.jsx)(Vt,{value:d.seconds_between_any_retrieval,handleChange:h("seconds_between_any_retrieval"),label:"Minimum time between any coupon retrievals"}),Object(r.jsx)(Vt,{value:d.seconds_between_same_retrieval,handleChange:h("seconds_between_same_retrieval"),label:"Minimum time between retrievals of the same group"}),Object(r.jsx)(Vt,{value:d.seconds_valid_after_distribution,handleChange:h("seconds_valid_after_distribution"),label:"Minimum time of coupon validity"}),Object(r.jsx)(Vt,{value:d.seconds_from_page_load_to_popup,handleChange:h("seconds_from_page_load_to_popup"),label:"Time between page load and popup display"}),Object(r.jsx)(B,{Icon:E.a,isLoading:u,onClick:function(){s(!0),ae.setOptions(d).finally((function(){return s(!1)}))},children:"Save options"})]})},Jt='\n<p style="text-align: center;">\n\tThis is some introduction text. It will be visible all the time.\n</p>\n<p style="text-align: center;">\n\tText with functionality is highlighted with a dashed border around (which won\'t be shown to the user).\n\tHover above it to see which functionality it has.\n\tClicking the four buttons above the content will toggle the functionality for the selected text.\n</p>\n<p style="text-align: center;">\n\t<button class="unique-coupons-popup__button">Clicking this button will fetch the coupon.</button>\n</p>\n<div class="unique-coupons-popup__coupon" style="text-align: center;">\n  This area will be hidden, until the coupon was successfully fetched.\n  Make sure to have the value marked up somewhere, or your users won\'t be very happy. For example:\n\tYour coupon is <span class="unique-coupons-popup__value">value</span>\n  and expires at <span class="unique-coupons-popup__expires-at" style="white-space: nowrap;">date</span>.\n\t"value" and "date" will be replaced with the according data.\n</div>\n',Wt=function(){var e=Object(p.b)(),t=Object(b.f)(),n=Object(c.useState)(""),a=Object(j.a)(n,2),o=a[0],i=a[1],u=Object(c.useState)(!1),s=Object(j.a)(u,2),l=s[0],d=s[1];return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(V,{initialValues:{name:"",description:"",template:Jt,isActive:!0},handleSubmit:function(n){n.name?(d(!0),e(re(n)).then(k.e).then((function(e){var n=e.id;return t.push("/group/".concat(n))})).catch((function(e){var t=e.message;return i(t)})).finally((function(){return d(!1)}))):i("Name cannot be empty.")},submitButtonText:"Add this coupon group",isLoading:l}),Object(r.jsx)(st.a,{open:!!o,autoHideDuration:6e3,message:o,onClose:function(e,t){return"clickaway"===t||i("")}})]})},Yt=function(e){var t=e.tabs;return Object(r.jsx)(we.a,{value:Object(b.g)().pathname,children:t.map((function(e,t){var n=e.path,a=e.label;return Object(r.jsx)(_e.a,{label:a,component:s.b,to:n,value:n},n)}))})},Qt=function(e){var t=e.children;return Object(r.jsx)(h.a,{children:Object(r.jsx)(f.a,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"center",maxHeight:"80vh",height:700,children:t})})};var Xt=Object(x.a)("div")({marginBottom:"80vh"}),Kt=function(){var e=Object(c.useState)(!0),t=Object(j.a)(e,2),n=t[0],a=t[1],o=Object(c.useState)(""),i=Object(j.a)(o,2),u=i[0],s=i[1],l=Object(p.b)();return Object(c.useEffect)((function(){l(oe()).then(k.e).catch((function(e){var t=e.message;return s(t)})).finally((function(){return a(!1)}))}),[l]),Object(r.jsxs)(Xt,{children:[Object(r.jsx)(Yt,{tabs:[{path:"/",label:"Groups"},{path:"/settings",label:"Settings"}]}),n||u?Object(r.jsx)(Qt,{children:n?Object(r.jsx)(g.a,{size:80}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(O.a,{variant:"h3",gutterBottom:!0,children:"Error loading data"}),Object(r.jsx)(O.a,{variant:"body1",children:u})]})}):Object(r.jsx)(h.a,{children:Object(r.jsx)(f.a,{padding:3,children:Object(r.jsxs)(b.c,{children:[Object(r.jsx)(b.a,{exact:!0,path:"/settings",children:Object(r.jsx)(Ht,{})}),Object(r.jsx)(b.a,{exact:!0,path:"/group/:groupId",render:function(e){var t=e.match;return Object(r.jsx)(ut,{groupId:Number(t.params.groupId)})}}),Object(r.jsx)(b.a,{exact:!0,path:"/add-coupons/:groupId",render:function(e){var t=e.match;return Object(r.jsx)(Ot,{groupId:Number(t.params.groupId)})}}),Object(r.jsx)(b.a,{exact:!0,path:"/add-coupon-group",children:Object(r.jsx)(Wt,{})}),Object(r.jsx)(b.a,{exact:!0,path:"/",children:Object(r.jsx)(Rt,{})}),Object(r.jsx)(b.a,{children:Object(r.jsx)("div",{children:"Invalid route"})})]})})})]})},Zt=Object(k.a)({reducer:{coupons:me}});u.a.render(Object(r.jsx)(o.a.StrictMode,{children:Object(r.jsx)(p.a,{store:Zt,children:Object(r.jsx)(d.b,{jss:Ye,children:Object(r.jsx)(s.a,{children:Object(r.jsx)(l.a,{children:Object(r.jsx)(Kt,{})})})})})}),Je)}},[[214,1,2]]]);
//# sourceMappingURL=main.052e3d4f.chunk.js.map